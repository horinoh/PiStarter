'CONST #GRP_POLY_PAGE=3
'CONST #GRP_POLY_WIDTH=96
'CONST #GRP_POLY_HEIGHT=96
'CONST #GRP_PPOLY_MARGIN=1
_GRP_POLY_PAGE=3
_GRP_POLY_WIDTH=96
_GRP_POLY_HEIGHT=96
_GRP_PPOLY_MARGIN=1

'COMMON DEF GRP_POLY_PAGE() RETURN #GRP_POLY_PAGE END
'COMMON DEF GRP_POLY_WIDTH() RETURN #GRP_POLY_WIDTH END
'COMMON DEF GRP_POLY_HEIGHT() RETURN #GRP_POLY_HEIGHT END
'COMMON DEF GRP_POLY_MARGIN() RETURN #GRP_PPOLY_MARGIN END
COMMON DEF GRP_POLY_PAGE() RETURN _GRP_POLY_PAGE END
COMMON DEF GRP_POLY_WIDTH() RETURN _GRP_POLY_WIDTH END
COMMON DEF GRP_POLY_HEIGHT() RETURN _GRP_POLY_HEIGHT END
COMMON DEF GRP_POLY_MARGIN() RETURN _GRP_PPOLY_MARGIN END

'COMMON DEF GRP_POLY_ROW(I%) RETURN I% DIV (#GRPWIDTH DIV GRP_POLY_WIDTH()) END
'COMMON DEF GRP_POLY_COLUMN(I%) RETURN I% MOD (#GRPWIDTH DIV GRP_POLY_WIDTH()) END
VAR _GRPWIDTH=1280
VAR _GRPHEIGHT=1024
COMMON DEF GRP_POLY_ROW(I%) RETURN I% DIV (_GRPWIDTH DIV GRP_POLY_WIDTH()) END
COMMON DEF GRP_POLY_COLUMN(I%) RETURN I% MOD (_GRPWIDTH DIV GRP_POLY_WIDTH()) END

COMMON DEF GRP_DRAW_TRIANGLES PG%,W%,H%,MGN%,COL%
 'GTARGET PG%
 GPAGE 0,PG%

 GCLS

 VAR WMGN%=W%-MGN%
 VAR HMGN%=H%-MGN%
 VAR I%
 FOR I%=0 TO WMGN%-1
  VAR OFX%=GRP_POLY_COLUMN(I%)*GRP_POLY_WIDTH()
  VAR OFY%=GRP_POLY_ROW(I%)*GRP_POLY_HEIGHT()

  'IF OFY%>#GRPHEIGHT THEN  
  IF OFY%>_GRPHEIGHT THEN
   COLOR #YELLOW
   '?STR$(OFY%)+">"+STR$(#GRPHEIGHT)+" : EXCEEDING GRP PAGE SIZE"
   ?STR$(OFY%)+">"+STR$(_GRPHEIGHT)+" : EXCEEDING GRP PAGE SIZE"
   ?"GRPWIDTH * GRPHEIGHT=";
   '?#GRPWIDTH*#GRPHEIGHT
   ?_GRPWIDTH*_GRPHEIGHT
   ?"GRP_POLY_WIDTH * GRP_POLY_HEIGHT * GRP_POLY_WIDTH=";
   '?#GRP_POLY_WIDTH*#GRP_POLY_HEIGHT*#GRP_POLY_WIDTH
   ?_GRP_POLY_WIDTH*_GRP_POLY_HEIGHT*_GRP_POLY_WIDTH
   COLOR #WHITE
   BREAK
  ENDIF

  'IF I%>0 AND GRP_POLY_ROW(I%)!=GRP_POLY_ROW(I%-1) THEN ?"" ENDIF
  '?"["+STR$(I%)+"]";
  '?OFX%,OFY%

  GTRI OFX%+I%,OFY%, OFX%,OFY%+HMGN%, OFX%+WMGN%,OFY%+HMGN%, COL%
 NEXT
END

