OPTION STRICT

'LOAD "../MATH/MATH.PRG",1:EXEC 1
LOAD "PRG1:../MATH/MATH.PRG":EXEC 1

'LOAD "RENDER.PRG",2:EXEC 2
LOAD "PRG2:RENDER.PRG":EXEC 2

DEF MAIN
 ACLS

 'DEFAULT == 640X360
 'XSCREEN 1280,720

 GRP_DRAW_TRIANGLES GRP_POLY_PAGE(),GRP_POLY_WIDTH(),GRP_POLY_HEIGHT(),GRP_POLY_MARGIN(),RGB(127,127,127)
 'GPAGE GRP_POLY_PAGE(),0
 'SAVE "GRP3:TRI.PNG"

 SPPOLY_SETUP

 GPAGE 0,0

VAR M%=4,N%=4
'VAR M%=8,N%=8
'VAR M%=16,N%=16
 VAR IB%[0]
 SPPOLY_INDEX_BUFFER IB%,M%,N%
 '?"IB="
 'VAR I%:FOR I%=0 TO LEN(IB%)-1 ?IB%[I%] NEXT 

 VAR FUNC$="SPPOLY_PLANE"
 'VAR FUNC$="SPPOLY_SPHERE"
 'VAR FUNC$="SPPOLY_TORUS"
 VAR VB[0]
 SPPOLY_VERTEX_BUFFER VB,M%,N%,FUNC$
 'VAR I%:FOR I%=0 TO LEN(VB)-1 STEP 3 GPSET VB[I%]*100+320,VB[I%+1]*100+180,#WHITE NEXT

 'VAR NB[0]
 'SPPOLY_NORMAL_BUFFER NB,M%,N%,FUNC$
 '?"NB="
 'VAR I%:FOR I%=0 TO LEN(NB)-1 ?NB[I%] NEXT 

 VAR M[4,4]'=[100,0,0,0, 0,100,0,0, 0,0,1,0, 320,180,0,1]
 M[0,0]=100:M[0,1]=0:M[0,2]=0:M[0,3]=0
 M[1,0]=0:M[1,1]=100:M[1,2]=0:M[1,3]=0
 M[2,0]=0:M[2,1]=0:M[2,2]=1:M[2,3]=0
 M[3,0]=320:M[3,1]=180:M[3,2]=0:M[3,3]=1

 VAR VBT[0]
 SPPOLY_TRANSFORM VBT,VB,M
 SPPOLY_DRAW_INDEXED IB%,VBT

 SPPOLY_CLEAR
 
 CALL SPRITE
END

MAIN

