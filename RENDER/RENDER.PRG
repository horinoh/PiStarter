'CONST #GRP_POLY_PAGE=3
'CONST #GRP_POLY_WIDTH=96
'CONST #GRP_POLY_HEIGHT=96
'CONST #GRP_PPOLY_MARGIN=1
_GRP_POLY_PAGE=3
_GRP_POLY_WIDTH=96
_GRP_POLY_HEIGHT=96
_GRP_PPOLY_MARGIN=1

'COMMON DEF GRP_POLY_PAGE() RETURN #GRP_POLY_PAGE END
'COMMON DEF GRP_POLY_WIDTH() RETURN #GRP_POLY_WIDTH END
'COMMON DEF GRP_POLY_HEIGHT() RETURN #GRP_POLY_HEIGHT END
'COMMON DEF GRP_POLY_MARGIN() RETURN #GRP_PPOLY_MARGIN END
COMMON DEF GRP_POLY_PAGE() RETURN _GRP_POLY_PAGE END
COMMON DEF GRP_POLY_WIDTH() RETURN _GRP_POLY_WIDTH END
COMMON DEF GRP_POLY_HEIGHT() RETURN _GRP_POLY_HEIGHT END
COMMON DEF GRP_POLY_MARGIN() RETURN _GRP_PPOLY_MARGIN END

'COMMON DEF GRP_POLY_ROW(I%) RETURN I% DIV (#GRPWIDTH DIV GRP_POLY_WIDTH()) END
'COMMON DEF GRP_POLY_COLUMN(I%) RETURN I% MOD (#GRPWIDTH DIV GRP_POLY_WIDTH()) END
VAR _GRPWIDTH=1280
VAR _GRPHEIGHT=1024
COMMON DEF GRP_POLY_ROW(I%) RETURN I% DIV (_GRPWIDTH DIV GRP_POLY_WIDTH()) END
COMMON DEF GRP_POLY_COLUMN(I%) RETURN I% MOD (_GRPWIDTH DIV GRP_POLY_WIDTH()) END

DEF VERIFY_DRAWING_RANGE(I%)
VAR MXROW=GRP_POLY_ROW(i%)
 VAR MXY=MXROW*GRP_POLY_HEIGHT()
 'VAR MXCOL=#GRPWIDTH DIV GRP_POLY_WIDTH()
 VAR MXCOL=_GRPWIDTH DIV GRP_POLY_WIDTH()
 VAR MXX=MXCOL*GRP_POLY_WIDTH()
 '?"POLY SIZE=";
 '?GRP_POLY_WIDTH();
 '?"x";
 '?GRP_POLY_HEIGHT()
 '?"COLUMNxROW=";
 '?MXCOL;
 '?"x";
 '?MXROW
 'IF MXY>#GRPHEIGHT THEN
 IF MXY>_GRPHEIGHT THEN 
  COLOR #YELLOW
  ?"REQUIRED SIZE=";
  ?MXX;
  ?"x";
  ?MXY
  ?"LIMIT SIZE=";
  '?#GRPWIDTH;
  ?_GRPWIDTH;
  ?"x";
  '?#GRPHEIGHT
  ?_GRPHEIGHT
  COLOR #WHITE
  RETURN #FALSE
 ENDIF
 RETURN #TRUE
END

COMMON DEF GRP_DRAW_TRIANGLES PG%,W%,H%,MGN%,COL%
 'GTARGET PG%
 GPAGE 0,PG%

 GCLS

 VAR WMGN%=W%-MGN%
 VAR HMGN%=H%-MGN%
 VAR I%
 
 IF !VERIFY_DRAWING_RANGE(WMGN%-1) THEN RETURN ENDIF

 FOR I%=0 TO WMGN%-1
  VAR OFX%=GRP_POLY_COLUMN(I%)*GRP_POLY_WIDTH()
  VAR OFY%=GRP_POLY_ROW(I%)*GRP_POLY_HEIGHT()
  GTRI OFX%+I%,OFY%, OFX%,OFY%+HMGN%, OFX%+WMGN%,OFY%+HMGN%, COL%
 NEXT
END

